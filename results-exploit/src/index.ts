import * as program from 'commander'
import { computeIntegrationTimesLS } from './integration-times-ls'
import { computeIntegrationTimesRenameOp } from './integration-times-rename-op'
import { computeIntegrationTimesRLS } from './integration-times-rls'
import { computeSnapshotSizes } from './snapshot-sizes'

// Retrieve version from package.json
let version: string
try {
  version = require('../package.json').version
} catch (err) {
  version = ''
}

program
  .version(version)
  .option('-v, --verbose', 'Verbose mode')
  .option(
    '--integration-times-ls',
    'Compute integration times of operations on LogootSplit documents'
  )
  .option('--integration-times-rename-op', 'Compute integration times of rename ops')
  .option(
    '--integration-times-rls',
    'Compute integration times of operations on RenamableLogootSplit documents'
  )
  .option('--snapshot-sizes', 'Compute sizes of snapshots')
  .parse(process.argv)

if (program.integrationTimesLs) {
  computeIntegrationTimesLS()
} else if (program.integrationTimesRenameOp) {
  computeIntegrationTimesRenameOp()
} else if (program.integrationTimesRls) {
  computeIntegrationTimesRLS()
} else if (program.snapshotSizes) {
  computeSnapshotSizes()
} else {
  program.help()
}
