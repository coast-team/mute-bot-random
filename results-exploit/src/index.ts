import * as program from 'commander'
import { Experiment } from './Experiment'
import { Result } from './Result'

// Retrieve version from package.json
let version: string
try {
  version = require('../package.json').version
} catch (err) {
  try {
    version = require('./package.json').version
  } catch {
    log.error(err)
    version = ''
  }
}

program
  .version(version)
  .option('-v, --verbose', 'Verbose mode')
  .option('-e, --experiment [file]', 'Run Experiment on the snapshot')
  .parse(process.argv)

if (program.experiment) {
  console.log('Experiment on file :', program.experiment)
  const e = new Experiment(program.experiment, 1000)
  e.start()
} else {
  const res = new Result()
  console.log(res.checkString())
}
