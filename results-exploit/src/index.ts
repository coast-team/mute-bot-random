import * as program from 'commander'
import { Experiment } from './Experiment'

const fs = require('fs')

// Retrieve version from package.json
let version: string
try {
  version = require('../package.json').version
} catch (err) {
  try {
    version = require('./package.json').version
  } catch {
    log.error(err)
    version = ''
  }
}

program
  .version(version)
  .option('-v, --verbose', 'Verbose mode')
  .option('-s, --snapshot [file]', 'Run Experiment on the snapshot')
  .option('-c, --config [file]', 'The configuration of tests')
  .parse(process.argv)

const config = JSON.parse(fs.readFileSync(program.config))
const exp = new Experiment(config, program.snapshot)
exp.start()
/*
if (program.experiment) {
  console.log('Experiment on file :', program.experiment)
  const e = new Experiment(program.experiment, 1000)
  e.start()
} else {
  const res = new Result()
  console.log(res.checkString())
}
*/
