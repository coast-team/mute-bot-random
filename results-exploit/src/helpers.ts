import { LogootSAdd, LogootSDel, LogootSRename, RenamableLogootSAdd, RenamableLogootSDel } from 'mute-structs'

export function random (max: number) {
    return Math.floor(Math.random() * (max + 1))
}

export function fromPlainLogootSOperation (operation: unknown): LogootSAdd | LogootSDel {
    let result: LogootSAdd | LogootSDel | null = LogootSAdd.fromPlain(operation)
    if (result === null) {
        result = LogootSDel.fromPlain(operation)
        if (result === null) {
            throw new Error("Was not able to deserialize operation")
        }
    }
    return result
}

export function fromPlainRenamableListSOperation (operation: unknown): LogootSRename | RenamableLogootSAdd | RenamableLogootSDel {
    let result: LogootSRename | RenamableLogootSAdd | RenamableLogootSDel | null = RenamableLogootSAdd.fromPlain(operation)
    if (result === null) {
        result = RenamableLogootSDel.fromPlain(operation)
        if (result === null) {
            result = LogootSRename.fromPlain(operation)
            if (result === null) {
                throw new Error("Was not able to deserialize operation")
            }
        }
    }
    return result
}

export function reshapeArray<T> (array: T[], threshold: number): T[][] {
    const initialValue: T[][] = []
    return array.reduce((acc, value, index) => {
        if (index % threshold === 0) {
            acc.push([])
        }
        acc[acc.length - 1].push(value)
        return acc
    }, initialValue)
}

const folders7k5RLS1 = [
    "1634277601",
    "1634364001",
    "1634450402",
    "1634536801",
    "1634623201",
    "1634709602",
    "1634796001",
    "1634882401",
    "1634968802",
    "1635055201",
    "1635141601",
    "1635228001",
    "1635314401",
    "1635400801",
    "1635487201",
    "1635573601",
    "1635663601",
    "1635750001",
    "1635836401",
    "1635922801",
    "1636009202",
]

const folders7k5RLS2 = [
    "1635764401",
    "1635850801",
    "1635937201",
    "1634292001",
    "1634378402",
    "1634464801",
    "1634551201",
    "1634637601",
    "1634724001",
    "1634810401",
    "1634896801",
    "1634983201",
    "1635069601",
    "1635156001",
    "1635242401",
    "1635328801",
    "1635415201",
    "1635501601",
    "1635588001",
    "1635678001",
]

const folders7k5RLS3 = [
    "1634220001",
    "1634306401",
    "1634392801",
    "1634479201",
    "1634565601",
    "1634652001",
    "1634738401",
    "1634824801",
    "1634911201",
    "1634997601",
    "1635084002",
    "1635170401",
    "1635256801",
    "1635343201",
    "1635429602",
    "1635516001",
    "1635602401",
    "1635692401",
    "1635778801",
    "1635865201",
    "1635951601",
]

const folders7k5RLS4 = [
    "1635793202",
    "1635879601",
    "1635966001",
    "1634234401",
    "1634320802",
    "1634407201",
    "1634493601",
    "1634580001",
    "1634666401",
    "1634752802",
    "1634839201",
    "1634925601",
    "1635012001",
    "1635098401",
    "1635184801",
    "1635271201",
    "1635357601",
    "1635444002",
    "1635530401",
    "1635616802",
    "1635706801",
]

const foldersRLS4 = [
    "1594392615",
    "1595786402",
    "1594922401",
    "1595095201",
    "1594836001",
    "1594663201",
    "1595268002",
    "1594490401",
    "1595527201",
    "1595181601",
    "1595872801",
    "1595440802",
    "1594749601",
    "1594406971",
    "1595959201",
    "1594455838",
    "1595354402",
    "1595700001",
    "1595613601",
    "1594576801",
    "1595008801"
]

// folders simulations with 3 renamingBots
const foldersRLS3 = [
    "1595944802",
    "1595080801",
    "1594562401",
    "1595426401",
    "1595253601",
    "1595599201",
    "1594735201",
    "1594821601",
    "1595167201",
    "1594476001",
    "1595858402",
    "1595340002",
    "1595512801",
    "1594994401",
    "1595685601",
    "1595772002",
    "1594648801",
    "1594908001"
]

// folders simulations with 2 renamingBots
const foldersRLS2 = [
    "1594634401",
    "1595239202",
    "1595066402",
    "1595584801",
    "1594461601",
    "1594807201",
    "1595930401",
    "1594548002",
    "1595844001",
    "1594980001",
    "1595757601",
    "1595412001",
    "1594720802",
    "1594893601",
    "1595325601",
    "1595152801",
    "1595671202",
    "1595498401"
]

// folders simulations with 1 renamingBot
const foldersRLS1 = [
    "1595829602",
    "1594879201",
    "1595656801",
    "1595570402",
    "1596002401",
    "1594533601",
    "1595916001",
    "1595397602",
    "1594792802",
    "1594965601",
    "1595743201",
    "1595138401",
    "1595224801",
    "1594620002",
    "1595311202",
    "1595052001",
    "1594706401",
    "1595484001"
]

const foldersLS = [
    "1595210401",
    "1595383201",
    "1594692001",
    "1595037602",
    "1595124002",
    "1595296801",
    "1595901601",
    "1595815202",
    "1595556002",
    "1595642401",
    "1594864801",
    "1594951201",
    "1595728802",
    "1594605601",
    "1594519201",
    "1594778401",
    "1595988001",
    "1595469601",
]

export const mapFolders = new Map<string, string[]>([
    ["ls", foldersLS],
    ["rls-7k5-1-renaming-bots", folders7k5RLS1],
    ["rls-7k5-2-renaming-bots", folders7k5RLS2],
    ["rls-7k5-3-renaming-bots", folders7k5RLS3],
    ["rls-7k5-4-renaming-bots", folders7k5RLS4],
    ["rls-30k-1-renaming-bots", foldersRLS1],
    ["rls-30k-2-renaming-bots", foldersRLS2],
    ["rls-30k-3-renaming-bots", foldersRLS3],
    ["rls-30k-4-renaming-bots", foldersRLS4],
])
