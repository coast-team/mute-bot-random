#! /bin/bash

# Start command : ./result.sh [snapshot] [config]

if [[ $# -lt 2 ]]
then
  echo "Invalid Argument : ./result.sh snapshot config"
  exit 1
fi

cp $1 ./input/snapshot.json
cp $2 ./input/config.json

image=`docker images -a | grep resultexploit`
if [[ -z $image ]]
then 
  docker build -t resultexploit ./result-exploit/
fi

node ./createDockerCompose.js
docker stack deploy -c ./docker-compose-parallel.yml result

